<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv=”Access-Control-Allow-Origin” content=”*”>
    <title>统计分析管理</title>


</head>

<body>


<!-- 比中率统计3 以下-->
<div class="container-fluid face-table-group">
    <div class="row">
        <div class="form-inline face-form">
            <div class="form-group">
                <select id="timestatus" class="form-control" onchange="changeTime()">
                    <option value="-1">统计方式</option>
                    <option value="0">按年统计</option>
                    <option value="1">按月统计</option>
                    <option value="2">按天统计</option>
                    <option value="3">按时统计</option>
                </select>
            </div>
            <div class="form-group mydate">
                <input size="22" type="text" value="" readonly id="startDate" class="form-control"
                       placeholder="开始时间">
                <input size="22" type="text" value="" readonly id="endDate" class="form-control" placeholder="结束时间">
            </div>
            <div class="form-group button-group">
                <button class="btn face-button" onclick="getMessage3()" id="btn-query"><span class="fa fa-search"
                                                                                             aria-hidden="true"></span>搜索
                </button>
                <button class="btn face-button2" onclick="reset3()" id="btn-reset"><span class="fa fa-search"
                                                                                         aria-hidden="true"></span>重置
                </button>
            </div>
        </div>
    </div>
    <div class="row tablediv">
        <table id="proportion"

               data-pagination="true" data-side-pagination="server"
               data-page-list="[10, 20, 50, 100, ALL]" data-page-size="10"
               class="table table-striped face-table">
            <thead>
            <tr>
                <th data-field="date" data-halign="center" data-align="center" data-valign="middle">起始时间</th>
                <th data-field="plat" data-halign="center" data-align="center" data-valign="middle">平台比中数</th>
                <th data-field="platcount" data-halign="center" data-align="center" data-valign="middle">平台比对数</th>
                <th data-field="platper" data-halign="center" data-align="center" data-valign="middle">平台准确率</th>
                <th data-field="app" data-halign="center" data-align="center" data-valign="middle">app比中数</th>
                <th data-field="appcount" data-halign="center" data-align="center" data-valign="middle">app比对量</th>
                <th data-field="appper" data-halign="center" data-align="center" data-valign="middle">app准确率</th>
            </tr>
            </thead>
            <tbody id="countBody3">
            </tbody>
        </table>
    </div>
</div>
<!-- 比中率统计3 以上-->


</body>


<!--比中率3-以下----->
<script type="text/javascript">

    getMessage3();
    $(".mydate input").datetimepicker({
        format: 'yyyy-mm-dd hh:ii',
        language: 'zh-CN',
        autoclose: true,
        inputMask: true,
    });

    function changeTime() {
        var date = new Date();
        var y = date.getFullYear();
        var seperator1 = "-";
        var seperator2 = ":";
        var month = date.getMonth() + 1;
        var strDate = date.getDate();
        var hour = date.getHours();
        if (month >= 1 && month <= 9) {
            month = "0" + month;
        }
        if (strDate >= 0 && strDate <= 9) {
            strDate = "0" + strDate;
        }
        var m = date.getFullYear() + seperator1 + month;
        var d = date.getFullYear() + seperator1 + month + seperator1 + strDate;
        var h = date.getFullYear() + seperator1 + month + seperator1 + strDate + seperator1 + hour;
        var s = $("#timestatus").find("option:selected").val();
        if (s == 0) {
            $("#startDate").datetimepicker('remove');
            $("#endDate").datetimepicker('remove');
            getDateByYear(y);
        } else if (s == 1) {
            $("#startDate").datetimepicker('remove');
            $("#endDate").datetimepicker('remove');
            getDateByMonth(m);
        } else if (s == 2) {
            $("#startDate").datetimepicker('remove');
            $("#endDate").datetimepicker('remove');
            getDateByDay(d);
        } else {
            $("#startDate").datetimepicker('remove');
            $("#endDate").datetimepicker('remove');
            getDateByHour(h);
        }
    }
    function changeTable() {
        var f = $("#fashion").find("option:selected").val();
        if (f == 0) {
            $("#first").bootstrapTable('destroy');
            $("#third").bootstrapTable('destroy');
            $("#four").bootstrapTable('destroy');
            $("#five").bootstrapTable('destroy');
            $("#second").css("display", "");
            $("#first").css("display", "none");
            $("#third").css("display", "none");
            $("#four").css("display", "none");
            $("#five").css("display", "none");
        } else if (f == 1) {
            $("#first").bootstrapTable('destroy');
            $("#second").bootstrapTable('destroy');
            $("#four").bootstrapTable('destroy');
            $("#five").bootstrapTable('destroy');
            $("#third").css("display", "");
            $("#first").css("display", "none");
            $("#second").css("display", "none");
            $("#four").css("display", "none");
            $("#five").css("display", "none");
        } else if (f == 2) {
            $("#first").bootstrapTable('destroy');
            $("#third").bootstrapTable('destroy');
            $("#second").bootstrapTable('destroy');
            $("#five").bootstrapTable('destroy');
            $("#four").css("display", "");
            $("#first").css("display", "none");
            $("#second").css("display", "none");
            $("#third").css("display", "none");
            $("#five").css("display", "none");
        } else if (f == 3) {
            $("#first").bootstrapTable('destroy');
            $("#third").bootstrapTable('destroy');
            $("#four").bootstrapTable('destroy');
            $("#second").bootstrapTable('destroy');
            $("#five").css("display", "");
            $("#first").css("display", "none");
            $("#second").css("display", "none");
            $("#third").css("display", "none");
            $("#four").css("display", "none");
        } else {
            $("#second").bootstrapTable('destroy');
            $("#third").bootstrapTable('destroy');
            $("#four").bootstrapTable('destroy');
            $("#five").bootstrapTable('destroy');
            $("#first").css("display", "");
            $("#second").css("display", "none");
            $("#third").css("display", "none");
            $("#four").css("display", "none");
            $("#five").css("display", "none");
        }
    }
    function getMessage2() {
        changeTable();
        var start = $("#startDate").val();
        var end = $("#endDate").val();
        var type = $("#timestatus").find("option:selected").val();
        var fash = $("#fashion").find("option:selected").val();
        if (fash == 0) {
            SecondTable($("#second"), start, end, type, 0);
        } else if (fash == 1) {
            SecondTable($("#third"), start, end, type, 1);
        } else if (fash == 2) {
            SecondTable($("#four"), start, end, type, 2);
        } else if (fash == 3) {
            SecondTable($("#five"), start, end, type, 3);
        } else {
            SecondTable($("#first"), start, end, type, -1);
        }
    }
    function getDateByMonth() {
        //按月查询
        //$("#startDate").datetimepicker().format();
        $("#startDate").datetimepicker({
            format: "yyyy-mm",
            startView: 3,
            startDate: 3,
            todayHighlight: true,
            //showMeridian :true,
            autoclose: true,
            language: 'zh-CN',
            minView: 4,
            todayBtn: true,
        }).on("change", function (ev) {
            var start = $('#startDate').val();
            $('#endDate').datetimepicker('setStartDate', start);
            $('#startDate').datetimepicker('hide');
        });
        $("#endDate").datetimepicker({
            format: "yyyy-mm",
            startView: 3,
            showMeridian: true,
            autoclose: true,
            language: 'zh-CN',
            minView: 4,
            todayBtn: true,
        }).on("change", function (ev) {
            var end = $('#endDate').val();
            $('#startDate').datetimepicker('setEndDate', new Date());
            $('#endDate').datetimepicker('setStartDate', new Date());
        });
    }

    function getDateByYear(y) {
        //按年查询
        $("#startDate").datetimepicker({
            format: "yyyy",
            startView: 'decade',
            startDate: "2006",
            endDate: "2020",
            //todayHighlight:true,
            showMeridian: true,
            autoclose: true,
            language: 'zh-CN',
            minView: 'decade',
            //todayBtn:true,
        });
        /*.on("changeYear",function(ev){
         $("#startDate").datetimepicker('setStartDate',y-10);
         $("#startDate").datetimepicker('setEndDate',$('#endDate').val());
         })*/
        $("#endDate").datetimepicker({
            format: "yyyy",
            startView: 'decade',
            showMeridian: true,
            autoclose: true,
            language: 'zh-CN',
            minView: 'decade',
            todayBtn: true,
        }).on("change", function (ev) {
            var end = $('#endDate').val();
            $('#endDate').datetimepicker('setStartDate', $('#startDate').val());
            $('#endDate').datetimepicker('setEndDate', y);
        });
    }
    function getDateByDay() {
        //按天查询
        $("#startDate").datetimepicker({
            format: "yyyy-mm-dd",
            startDate: 4,
            todayHighlight: true,
            showMeridian: true,
            autoclose: true,
            language: 'zh-CN',
            minView: 2,
            todayBtn: true,
        }).on("change", function (ev) {
            var start = $('#startDate').val();
            $('#endDate').datetimepicker('setStartDate', start);
            $('#startDate').datetimepicker('hide');
        });
        $("#endDate").datetimepicker({
            format: "yyyy-mm-dd",
            showMeridian: true,
            autoclose: true,
            language: 'zh-CN',
            minView: 2,
            todayBtn: true,
        }).on("change", function (ev) {
            var end = $('#endDate').val();
            $('#startDate').datetimepicker('setEndDate', new Date());
            $('#endDate').datetimepicker('setStartDate', new Date());
        });
    }
    function getDateByHour() {
        //按小时查询
        $("#startDate").datetimepicker({
            format: "yyyy-mm-dd-hh",
            todayHighlight: true,
            showMeridian: true,
            autoclose: true,
            inputMask: true,
            language: 'zh-CN',
            minView: 1,
            todayBtn: true,
        }).on("change", function (ev) {
            var start = $('#startDate').val();
            $('#endDate').datetimepicker('setStartDate', start);
            $('#startDate').datetimepicker('hide');
        });
        $("#endDate").datetimepicker({
            format: "yyyy-mm-dd-hh",
            showMeridian: true,
            autoclose: true,
            language: 'zh-CN',
            minView: 1,
            todayBtn: true,
        }).on("change", function (ev) {
            var end = $('#endDate').val();
            $('#startDate').datetimepicker('setEndDate', new Date());
            $('#endDate').datetimepicker('setStartDate', new Date());
        });
    }

    function getMessage3() {
        var start = $("#startDate").val();
        var end = $("#endDate").val();
        var type = $("#timestatus").find("option:selected").val();
        getTable3(start, end, type);
    }

    function getTable3(start, end, type) {
        $("#proportion").bootstrapTable('destroy');
        $("#proportion").bootstrapTable({
            method: "post",
            url: pathurl + "syslog/proportioncount?startDate=" + start + "&endDate=" + end + "&dateType=" + type,
            pagination: true,
            contentType: "application/x-www-form-urlencoded",
            queryParamsType: " limit",
            paginationDetailHAlign: "left",
            //paginationPreText : "上一页",
            //paginationNextText : "下一页",
            searchOnEnterKey: true
        });
    }
    function reset3() {
        $(".face-form input").val("");
        $(".face-form select").val("-1");
        getMessage3();
    }
</script>
<!--比中率3-以上----->

</html>
