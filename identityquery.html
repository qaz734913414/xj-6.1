<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv=”Access-Control-Allow-Origin” content=”*”>
    <title>统计分析管理</title>


</head>

<body>


<<!-- 身份查询4 以下-->

<div class="container-fluid face-table-group">
    <div class=" row">
        <div class="form-inline face-form">
            <div class="form-group">
                <input id="idno" size="22" type="text" value="" class="form-control" placeholder="身份证号">
                <input id="name" size="22" type="text" value="" class="form-control" placeholder="姓名">
            </div>
            <div class="form-group button-group">
                <button class="btn face-button" onclick="getMessage4()" id="btn-query"><span class="fa fa-search"
                                                                                             aria-hidden="true"></span>搜索
                </button>
                <button class="btn face-button2" onclick="reset4()" id="btn-reset"><span class="fa fa-search"
                                                                                         aria-hidden="true"></span>重置
                </button>
            </div>
        </div>

        <div class="row result-box ">
            <div class="container-fluid">
                <div class="row">

                </div>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="retrieveModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><span
                        class="fa fa-times" aria-hidden="true"></span></button>
                <h4 class="modal-title">身份查询详情</h4>
            </div>
            <div class="modal-body">
                <div class="row">

                    <div class="col-sm-4 col-md-4 col-lg-4 text-center show-results">
                        <button type="button" class="btn left-btn"><span class="fa  fa-chevron-left"></span>
                        </button>
                        <h4>查询结果</h4>
                        <button type="button" class="btn right-btn"><span class="fa  fa-chevron-right"
                                                                          aria-hidden="true"></span>
                        </button>
                        <div class="thumbnail">
                            <img id="modal-img" src="./img/default_img.png" alt="...">
                        </div>
                    </div>
                    <div class="col-sm-3 col-md-3 col-lg-3 items">
                        <h4 class="text-center">身份信息详情</h4>
                        <h4> &nbsp;</h4>
                        <div class="caption">
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal -->
</div>



<div class="modal fade face-modal" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" style="margin: 10% auto;width: 20%;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title" id="myModalLabel"></h4>
            </div>
            <div class="modal-body" style="text-align:center;" id="modal-body-id"></div>
            <div class="modal-footer" style="text-align:center;">
                <button type="button" class="btn btn-primary" data-dismiss="modal">知道了
                </button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal -->
</div>
<!-- 身份查询 以上-->


</body>
<script id="imgTemp" type="text/html">
    <div class="col-sm-4 col-md-3 col-lg-2">
        <div class="thumbnail {{= focus==''?'':' focus'}}">
            <img src={{= url}} alt="...">
            <div class="caption">
                <p>姓名：{{= name}}</p>
                <p>年龄：{{= age}}</p>
                <p>性别：{{= sex}}</p>
                <p>地区：{{= address}}</p>
                <p class="hidden">身份证号：{{= idno}}</p>
                {{if focus}}
                <p class="hidden focus-font">重点人员情况：{{= focus}}'</p>
                {{/if}}
            </div>
        </div>
    </div>
</script>

<!--身份查询4-以下----->
<script type="text/javascript">
    var heightFactor = 1.2;
    function getMessage4() {
        var upload = $(this);
        upload.addClass("disabled");
        var form_Data = new FormData();
        form_Data.append("idno", $(".mydate #idno").val());
        form_Data.append("name", $(".mydate #name").val());
        $.ajax({
            type: 'post',
            url: pathurl + 'syslog/identityquery',
            data: form_Data,
            cache: false,
            contentType: false,
            processData: false,
            dataType: 'json',
            success: function (data) {
                console.info(data);
                if (data.code == 0) {
                    $(".result-box .container-fluid .row").html("");//清空
                    var imgs = data.userlist;
                    var imgsDom = $(".result-box .container-fluid .row");
                    //排序
                    /* imgs.sort(function(a,b){
                     return b.percent-a.percent;
                     }); */
                    $('#imgTemp').tmpl(imgs).appendTo(imgsDom);
                    winChange();//调整高宽
                    //绑定图片点击事件
                    $(".result-box .thumbnail").bind('click', function () {
                        //var b=$(".result-box .thumbnail p").removeClass("hidden");
                        $("#retrieveModal").modal();
                        //赋值
                        showImageOnModal($(this));
                        //设置当前图片dom的索引，以便左右翻图
                        var imageDom = $(this);
                        //绑定左右切换事件
                        $("#retrieveModal .right-btn").bind("click", function () {
                            if (!imageDom.parent().next().find(".thumbnail img").attr("src")) {
                                return;
                            }
                            imageDom = imageDom.parent().next().find(".thumbnail");
                            showImageOnModal(imageDom);
                        });

                        $("#retrieveModal .left-btn").bind("click", function () {
                            if (!imageDom.parent().prev().find(".thumbnail img").attr("src")) {
                                return;
                            }
                            imageDom = imageDom.parent().prev().find(".thumbnail");
                            console.info(imageDom);
                            showImageOnModal(imageDom);
                        });
                        //绑定按钮事件
                        $("#retrieveModal .similar-box").bind("mouseover", function () {
                            $("#retrieveModal .similar-box > p:last-child").hide();
                            $("#retrieveModal .similar-box > p:first-child span").text("比 中");
                            $("#retrieveModal .similar-box").addClass("selected");
                        });
                        $("#retrieveModal .similar-box").bind("mouseout", function () {
                            $("#retrieveModal .similar-box > p:last-child").show();
                            $("#retrieveModal .similar-box > p:first-child span").text("相似度");
                            $("#retrieveModal .similar-box").removeClass("selected");
                        });
                        winChange();
                    });

                } else {
                    $("#modal-body-id").text("操作失败，请重试");
                    $("#myModal").modal();

                }

            },
            error: function () {

                console.error("ajax upload error");
            }
        });
    }

    function winChange() {

        //统一图片高度，防止不对齐
        var width = $(".result-box .thumbnail img").width();
        $(".result-box .thumbnail img").height(width * heightFactor);
        //图片对齐
        width = $("#retrieveModal .modal-body .thumbnail img").width();
        $("#retrieveModal .modal-body .thumbnail img").height(width * heightFactor);
        //按钮置园
        width = $("#retrieveModal .modal-body .similar-box").width();
        $("#retrieveModal .modal-body .similar-box").height(width);

        width = $(".add-img-box .thumbnail img").width();
        $(".add-img-box .thumbnail img").height(width * heightFactor);
        //图片框垂直居中

    }
    function showImageOnModal(resource) {
        $("#modal-img").attr("src", resource.find("img").attr("src"));
        $("#retrieveModal .similar-box p:last-child span").html(resource.find(".caption>p:first-child>span:last-child").html());
        $("#retrieveModal .caption").html(resource.find(".caption").html());
        $("#retrieveModal .caption .hidden").removeClass("hidden");
        //$("#retrieveModal .caption p:first-child").addClass("hidden");
        //重点人员
        if (resource.hasClass("focus")) {
            $("#retrieveModal .show-results .thumbnail").addClass("focus");
        } else {
            $("#retrieveModal .show-results .thumbnail").removeClass("focus");
        }
    }
    function reset4() {
        $(".face-form input").val("");
    }
</script>

</html>
